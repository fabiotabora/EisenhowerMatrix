<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Matriz de Eisenhower</title>

  <style>
    :root{
      --bg:#0b0f19;
      --text:#e9efff;
      --muted:#8ea0c6;
      --border: rgba(255,255,255,.12);
      --border2: rgba(255,255,255,.18);
      --panel: rgba(255,255,255,.04);
      --panel2: rgba(0,0,0,.25);
      --shadow: 0 14px 34px rgba(0,0,0,.35);
      --radius: 16px;
    }
    
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: var(--bg);
      color: var(--text);
    }

    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 22px 14px 70px;
    }

    h1{ margin:0 0 6px; font-size:22px; }
    .sub{ margin:0 0 18px; color:var(--muted); font-size:14px; }

    .meta{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin: 14px 0 16px;
    }

    .meta input{
      width:100%;
      padding: 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      outline:none;
    }

    /* ===== Matriz ===== */
    .eisenhower{
      display:grid;
      grid-template-columns: 120px 1fr 1fr;
      grid-template-rows: 40px auto auto;
      gap: 10px;
      margin-top: 12px;
    }

    .corner{ }

    .col-title{
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:12px;
      letter-spacing:.8px;
      color: var(--muted);
    }

    .row-title{
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:12px;
      letter-spacing:.8px;
      color: var(--muted);
      writing-mode: vertical-rl;
      transform: rotate(180deg);
    }

    .quad{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--panel);
      box-shadow: var(--shadow);
      display:flex;
      flex-direction:column;
      min-height: 220px;
      overflow:hidden;
    }

    .quad-header{
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.02);
    }

    .qname{
      margin:0;
      font-size: 14px;
      font-weight:700;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }

    .badge{
      font-size:11px;
      color: var(--muted);
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--border2);
      background: rgba(0,0,0,.12);
    }

    .quad textarea{
      flex:1;
      width:100%;
      border:none;
      outline:none;
      padding:12px;
      background: var(--panel2);
      color: var(--text);
      font-size:14px;
      line-height:1.4;
      resize:vertical;
      min-height:140px;
    }

    .footer{
      margin-top: 16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 12px;
      flex-wrap:wrap;
      padding: 12px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
    }

    .status{
      color: var(--muted);
      font-size: 13px;
    }

    button{
      border: 1px solid var(--border2);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 14px;
      cursor:pointer;
    }

    .primary{
      border-color: rgba(96,165,250,.5);
      background: rgba(96,165,250,.16);
    }

    @media (max-width: 720px){
      .meta{ grid-template-columns: 1fr; }
      .eisenhower{ grid-template-columns: 1fr; }
      .corner, .col-title, .row-title{ display:none; }
      .quad{ min-height:auto; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <h1>Matriz de Eisenhower</h1>
    <p class="sub">Escribe una tarea por línea en cada cuadrante y luego presiona <strong>Submit</strong>.</p>

    <div class="meta">
      <input id="nombre" placeholder="Nombre (opcional)" />
      <input id="equipo" placeholder="Equipo / Rol (opcional)" />
    </div>

    <div class="eisenhower">
      <div class="corner"></div>
      <div class="col-title">URGENTE</div>
      <div class="col-title">NO URGENTE</div>

      <div class="row-title">IMPORTANTE</div>

      <div class="quad">
        <div class="quad-header">
          <p class="qname">IMPORTANTE · URGENTE <span class="badge">Alta / Alta</span></p>
        </div>
        <textarea id="iu" placeholder="Una tarea por línea"></textarea>
      </div>

      <div class="quad">
        <div class="quad-header">
          <p class="qname">IMPORTANTE · NO URGENTE <span class="badge">Alta / Baja</span></p>
        </div>
        <textarea id="in" placeholder="Una tarea por línea"></textarea>
      </div>

      <div class="row-title">NO IMPORTANTE</div>

      <div class="quad">
        <div class="quad-header">
          <p class="qname">NO IMPORTANTE · URGENTE <span class="badge">Baja / Alta</span></p>
        </div>
        <textarea id="nu" placeholder="Una tarea por línea"></textarea>
      </div>

      <div class="quad">
        <div class="quad-header">
          <p class="qname">NO IMPORTANTE · NO URGENTE <span class="badge">Baja / Baja</span></p>
        </div>
        <textarea id="nn" placeholder="Una tarea por línea"></textarea>
      </div>
    </div>

    <div class="footer">
      <div class="status" id="status">Listo para enviar.</div>
      <button class="primary" id="submit">Submit</button>
    </div>
  </div>

  <script>
    const ENDPOINT_URL =
      "https://script.google.com/macros/s/AKfycbyBOJALNAHsWfMcT7cew4BnBp46oBs2PkAkJNL0M4HObcKoggz6aV4Ib1EtVz53FF6J/exec";

    function parseLines(text){
      return (text || "")
        .split("\n")
        .map(t => t.trim())
        .filter(Boolean);
    }

    async function submitMatrix(){
      const map = [
        { id:"iu", quadrantLabel:"Importante / Urgente", importance:"Alta", urgency:"Alta" },
        { id:"in", quadrantLabel:"Importante / No urgente", importance:"Alta", urgency:"Baja" },
        { id:"nu", quadrantLabel:"No importante / Urgente", importance:"Baja", urgency:"Alta" },
        { id:"nn", quadrantLabel:"No importante / No urgente", importance:"Baja", urgency:"Baja" }
      ];

      const items = [];
      map.forEach(q => {
        const value = document.getElementById(q.id).value;
        parseLines(value).forEach(task => {
          items.push({
            quadrantLabel: q.quadrantLabel,
            importance: q.importance,
            urgency: q.urgency,
            task
          });
        });
      });

      if (!items.length){
        alert("Escribe al menos una tarea.");
        return;
      }

      const payload = {
        nombre: document.getElementById("nombre").value.trim(),
        equipo: document.getElementById("equipo").value.trim(),
        items
      };

      document.getElementById("status").textContent = "Enviando…";

      try {
        const res = await fetch(ENDPOINT_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify(payload)
        });

        const data = await res.json().catch(() => ({}));

        if (!res.ok || !data.ok) throw new Error(data.error || `HTTP ${res.status}`);

        document.getElementById("status").textContent = `✅ Enviado (${data.inserted} tareas)`;
        document.querySelectorAll("textarea").forEach(t => t.value = "");
      } catch (err) {
        console.error(err);
        document.getElementById("status").textContent = "❌ Error al enviar";
      }
    }

    document.getElementById("submit").addEventListener("click", submitMatrix);
  </script>
</body>
</html>
