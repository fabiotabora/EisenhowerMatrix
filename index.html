<!-- index.html (Frontend)
Guarda como index.html, abre en el navegador o s√∫belo a Netlify / GitHub Pages.
Tu ENDPOINT_URL ya est√° configurado con tu URL.
-->
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Matriz de Eisenhower ‚Äî Captura de prioridades</title>

  <style>
    :root{
      --bg:#0b0f19;
      --text:#e9efff;
      --muted:#8ea0c6;
      --border: rgba(255,255,255,.12);
      --border2: rgba(255,255,255,.18);
      --panel: rgba(255,255,255,.04);
      --panel2: rgba(0,0,0,.25);
      --shadow: 0 14px 34px rgba(0,0,0,.35);
      --radius: 16px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(96,165,250,.18), transparent 60%),
        radial-gradient(1000px 500px at 90% 10%, rgba(34,197,94,.14), transparent 55%),
        var(--bg);
      color: var(--text);
    }

    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 22px 14px 70px;
    }

    h1{
      margin: 0 0 6px;
      font-size: 22px;
      letter-spacing: .2px;
    }

    .sub{
      margin: 0 0 18px;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.45;
      max-width: 75ch;
    }

    .meta{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin: 14px 0 16px;
    }

    .meta input{
      width:100%;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      outline:none;
      box-shadow: var(--shadow);
      font-size: 14px;
    }

    /* ===== Eisenhower Matrix Layout ===== */
    .eisenhower{
      display:grid;
      grid-template-columns: 120px 1fr 1fr;
      grid-template-rows: 40px auto auto;
      gap: 10px;
      margin-top: 12px;
    }

    .corner{
      border: 1px dashed rgba(255,255,255,.12);
      border-radius: 14px;
      background: rgba(255,255,255,.02);
    }

    .col-title{
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight: 700;
      font-size: 12px;
      letter-spacing: .8px;
      color: var(--muted);
      border: 1px solid var(--border);
      border-radius: 14px;
      background: rgba(255,255,255,.03);
    }

    .row-title{
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight: 700;
      font-size: 12px;
      letter-spacing: .8px;
      color: var(--muted);
      border: 1px solid var(--border);
      border-radius: 14px;
      background: rgba(255,255,255,.03);
      writing-mode: vertical-rl;
      transform: rotate(180deg);
    }

    .quad{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--panel);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height: 220px;
    }

    .quad-header{
      padding: 12px 12px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.02);
    }

    .qname{
      margin:0;
      font-size: 14px;
      font-weight: 700;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }

    .badge{
      font-size: 11px;
      color: var(--muted);
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border2);
      background: rgba(0,0,0,.12);
      white-space: nowrap;
    }

    .qhint{
      margin: 6px 0 0;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.35;
    }

    .quad textarea{
      flex:1;
      width:100%;
      border: none;
      outline: none;
      padding: 12px;
      background: var(--panel2);
      color: var(--text);
      font-size: 14px;
      line-height: 1.4;
      resize: vertical;
      min-height: 140px;
    }

    .footer{
      margin-top: 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      flex-wrap:wrap;
      padding: 12px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
    }

    .status{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.4;
    }

    .actions{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
    }

    button{
      border: 1px solid var(--border2);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 14px;
      cursor:pointer;
    }
    button:hover{ background: rgba(255,255,255,.10); }

    .primary{
      border-color: rgba(96,165,250,.50);
      background: rgba(96,165,250,.16);
    }
    .primary:hover{ background: rgba(96,165,250,.22); }

    /* Mobile: stack quadrants, hide axis labels */
    @media (max-width: 720px){
      .meta{ grid-template-columns: 1fr; }
      .eisenhower{
        grid-template-columns: 1fr;
        grid-template-rows: auto;
      }
      .corner, .col-title, .row-title{ display:none; }
      .quad{ min-height: auto; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <h1>Matriz de Eisenhower</h1>
    <p class="sub">
      Escribe <strong>una tarea por l√≠nea</strong> en cada cuadrante. Luego presiona <strong>Submit</strong> para registrar todo.
    </p>

    <div class="meta">
      <input id="nombre" placeholder="Nombre (opcional)" />
      <input id="equipo" placeholder="Equipo / Rol (opcional)" />
    </div>

    <div class="eisenhower">
      <div class="corner"></div>
      <div class="col-title">URGENTE</div>
      <div class="col-title">NO URGENTE</div>

      <div class="row-title">IMPORTANTE</div>

      <div class="quad">
        <div class="quad-header">
          <p class="qname">üî• Hacer ahora <span class="badge">Imp: Alta ¬∑ Urg: Alta</span></p>
          <p class="qhint">Alta prioridad e inmediata. Acci√≥n hoy.</p>
        </div>
        <textarea id="iu" placeholder="Ej:\nRevisar bug en producci√≥n\nEnviar arte final a cliente\nAprobar copy para campa√±a"></textarea>
      </div>

      <div class="quad">
        <div class="quad-header">
          <p class="qname">üìÖ Planificar <span class="badge">Imp: Alta ¬∑ Urg: Baja</span></p>
          <p class="qhint">Importante, pero puede calendarizarse.</p>
        </div>
        <textarea id="in" placeholder="Ej:\nDocumentar proceso\nDefinir roadmap\nPreparar backlog"></textarea>
      </div>

      <div class="row-title">NO IMPORTANTE</div>

      <div class="quad">
        <div class="quad-header">
          <p class="qname">ü§ù Delegar <span class="badge">Imp: Baja ¬∑ Urg: Alta</span></p>
          <p class="qhint">Urgente, pero no requiere tu foco principal.</p>
        </div>
        <textarea id="nu" placeholder="Ej:\nResponder correo rutinario\nActualizar status en ticket\nAgendar reuni√≥n"></textarea>
      </div>

      <div class="quad">
        <div class="quad-header">
          <p class="qname">üóë Eliminar <span class="badge">Imp: Baja ¬∑ Urg: Baja</span></p>
          <p class="qhint">Bajo impacto. Evitar o posponer.</p>
        </div>
        <textarea id="nn" placeholder="Ej:\nRevisar algo ‚Äúpor si acaso‚Äù\nPerfeccionar detalles no cr√≠ticos\nTareas sin due√±o"></textarea>
      </div>
    </div>

    <div class="footer">
      <div class="status" id="status">Listo para enviar.</div>
      <div class="actions">
        <button id="clear">Limpiar</button>
        <button class="primary" id="submit">Submit</button>
      </div>
    </div>
  </div>

  <script>
    const ENDPOINT_URL =
      "https://script.google.com/macros/s/AKfycbzHUHW_PM19ivcyYtMXIlATVjXLmCwAPhSoFNk6W_4WcWvHJW5zjs-0CXPwysZbSlTw/exec";

    function parseLines(text){
      return (text || "")
        .split("\n")
        .map(s => s.trim())
        .filter(Boolean);
    }

    function setStatus(html){
      document.getElementById("status").innerHTML = html;
    }

    function collectItems(){
      const map = [
        { id: "iu", quadrantLabel: "üî• Importante + Urgente", importance: "Alta", urgency: "Alta" },
        { id: "in", quadrantLabel: "üìÖ Importante + No urgente", importance: "Alta", urgency: "Baja" },
        { id: "nu", quadrantLabel: "ü§ù No importante + Urgente", importance: "Baja", urgency: "Alta" },
        { id: "nn", quadrantLabel: "üóë No importante + No urgente", importance: "Baja", urgency: "Baja" }
      ];

      const items = [];
      map.forEach(q => {
        const text = document.getElementById(q.id).value;
        parseLines(text).forEach(task => {
          items.push({
            quadrantLabel: q.quadrantLabel,
            importance: q.importance,
            urgency: q.urgency,
            task
          });
        });
      });

      return items;
    }

    async function submitMatrix(){
      const items = collectItems();
      if (!items.length){
        alert("Escribe al menos una tarea (una por l√≠nea) en cualquier cuadrante.");
        return;
      }

      const payload = {
        nombre: document.getElementById("nombre").value.trim(),
        equipo: document.getElementById("equipo").value.trim(),
        items
      };

      setStatus(`Enviando‚Ä¶ <strong>${items.length}</strong> tarea(s)`);

      try {
        const res = await fetch(ENDPOINT_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify(payload)
        });

        const data = await res.json().catch(() => ({}));

        if (!res.ok || !data.ok){
          throw new Error(data.error || `HTTP ${res.status}`);
        }

        setStatus(`‚úÖ Enviado. Se registraron <strong>${data.inserted}</strong> tarea(s).`);
        document.querySelectorAll("textarea").forEach(t => t.value = "");
      } catch (err) {
        console.error(err);
        setStatus(`‚ùå Error al enviar: <strong>${String(err.message || err)}</strong>`);
        alert("Hubo un error al enviar. Revisa la consola (F12) o vuelve a intentar.");
      }
    }

    function clearAll(){
      if (!confirm("¬øSeguro que quieres limpiar los cuatro cuadrantes?")) return;
      document.querySelectorAll("textarea").forEach(t => t.value = "");
      setStatus("Listo para enviar.");
    }

    document.getElementById("submit").addEventListener("click", submitMatrix);
    document.getElementById("clear").addEventListener("click", clearAll);
  </script>
</body>
</html>
